<!DOCTYPE html>
<html>

<head>
	{% if title %}
	<title>{{ title }} - Keyence Vision System</title>
	{% else %}
	<title>Keyence Vision System</title>
	{% endif %}

	<meta name='viewport'
	content='user-scalable=yes, initial-scale=1, minimum-scale=1, width=device-width, height=device-height'>

	<!-- Favicon and Icons -->
	<link rel='apple-touch-icon" sizes="120x120" href="{{ url_for('static', filename='/res/apple-touch-icon.png') }}">
	<link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='/res/favicon-32x32.png') }}">
	<link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='/res/favicon-16x16.png') }}">
	<link rel="manifest" href="{{ url_for('static', filename='/res/site.webmanifest') }}">
	<link rel="mask-icon" href="{{ url_for('static', filename='/res/safari-pinned-tab.svg') }}" color="#5bbad5">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="theme-color" content="#ffffff">
	
	<!-- Fonts -->
	<link rel='stylesheet' type='text/css'
	href="{{ url_for('static', filename='styles/fonts.css') }}">
	
	<!-- CSS -->
	<link rel='stylesheet' type='text/css'
	href="{{ url_for('static', filename='styles/default-style.css') }}">

	<!-- Script -->
	{% if not no_header %}
	<script src="{{ url_for('static', filename='src/js/status-bar.js') }}" defer></script>
	{% endif %}
</head>

<body>

	{% if not no_header %}

	<!-- Checkbox to open/close navbar -->
	<input type='checkbox' id='nav-btn' {% if nav_closed %}checked{% endif %}/>

	<!-- Navbar -->
	<header id='navbar'>
		<div id='navbar-content'>

			<!-- Navbar top section -->
			<div>
				<!-- Title -->
				<h1>2D Barcode System</h1>
				<!-- Account info -->
				<p>Logged in as <span id='header-user'>{{ current_user.username }}</span></p>
				
				<!-- Navigation map for info -->
				<!-- link, title, parent, display (in navbar), admin required -->
				{% set navigation_map = [
					('index', 'Home', '', true, false),
					('cartridge', 'Cartridge Assembly QC', 'index', true, false),
					('laser', 'Laser Etch QC', 'index', true, false),
					('dashboard', 'Manage Users', '', true, true),
					('registration', '', 'dashboard', false, true),
					('change-pass', '', 'dashboard', false, true)] %}
				{% set active_page = active_page|default('index') -%}
				<ul>
					{% for href, name, parent, nav_display, admin_req in navigation_map %}
						{% if nav_display %}
							<!-- Only display admin-access pages if user has permission -->
							{% if not admin_req or (admin_req and (current_user.is_authenticated and current_user.has_admin_rights())) %}
								<li><a href='{{ url_for(href|e) }}' class='{% if href == active_page %}active{% endif %}{% if parent %} child{% endif %}'>{{ name|e }}</a></li>
							{% endif %}
						{% endif %}
					{% endfor %}
				</ul>
			</div>
			
			<!-- Navbar bottom section -->
			<div>
				<!-- Log out -->
				{% if not current_user.is_anonymous %}
				<a id='header-logout' href="{{ url_for('logout') }}">Log out >></a>
				{% endif %}
			</div>

		</div>
		
	</header>
	
	{% endif %}

	<div id='content-wrapper'>

		{% if not no_header %}

			<!-- Status bar -->
			<div id='status-bar'>
				<label for='nav-btn'>&#9776;</label>
				<ul>
					<li></li>
					<li><p id='time' title='Local System Time'>00:00:00 AM - 1/1/1970</p></li>
				</ul>
			</div>
	
		{% endif %}

		<!-- Main content -->
		<div id='content-body'>

			<!-- Show flash messages -->
			{% with messages = get_flashed_messages() %}
			{% if messages %}
			<ul class='flash'>
				{% for message in messages %}
				<li>{{ message }}</li>
				{% endfor %}
			</ul>
			{% endif %}
			{% endwith %}

			<!-- Back button, if page has a parent -->
			{% for href, name, parent, nav_display, admin_req in navigation_map %}
				{% if href == active_page and parent %}
					<div id='nav-back-container' class='container'>
						<!-- Back button -->
						<a class='bordered' href="{{ url_for(parent) }}"><< Back</a>
					</div>
				{% endif %}
			{% endfor %}

			{% block content %}{% endblock %}
		</div>
	</div>
	
</body>

</html>